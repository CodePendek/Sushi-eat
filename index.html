<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sushi Eat - Digital Menu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; -webkit-tap-highlight-color: transparent; scroll-behavior: smooth; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .glass { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); }
        .category-chip.active {
            background: #ea580c; color: white; border-color: #ea580c;
            transform: scale(1.05); box-shadow: 0 8px 15px -3px rgba(234, 88, 12, 0.3);
        }
        #cart-sidebar { transition: transform 0.3s cubic-bezier(0, 0, 0.2, 1); }
        
        /* Animasi Transisi Menu */
        .fade-in-up { animation: fadeInUp 0.4s ease-out; }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes custom-pulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.1); opacity: 0.8; }
}
.pulse-effect {
    animation: custom-pulse 1s infinite ease-in-out;
}

    </style>
</head>
<body class="bg-[#FCF8F5] text-slate-900 overflow-x-hidden">
    <div id="splash-screen" class="fixed inset-0 z-[100] bg-white flex flex-col items-center justify-center transition-opacity duration-700">
    <div class="relative">
        <div class="relative">
            <img src="logo.png" class="text-6xl animate-pulse w-40 inline-block">
        </div>
    </div>
</div>


    <nav class="fixed top-0 w-full z-40 glass border-b border-orange-100/50 px-6 h-16 flex items-center justify-between">
        <div class="flex items-center gap-2">
            <img src="logo-2.png" class="w-10" alt="" />
            <span class="font-black text-xl -pl-2 tracking-tighter uppercase">Sushi<span class="text-orange-600">Eat</span></span>
        </div>
        <button onclick="toggleSearch()" class="p-2.5 bg-slate-100 rounded-full text-slate-600 active:scale-90 transition-all">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
        </button>
    </nav>

    <div id="search-container" class="fixed top-16 left-0 w-full glass z-30 transition-all duration-300 -translate-y-full opacity-0 border-b border-orange-100">
        <div class="p-4">
            <input type="text" id="search-input" oninput="searchMenu()" placeholder="Cari menu favoritmu..." 
                class="w-full bg-white border border-slate-200 rounded-2xl py-3 px-5 focus:outline-none focus:ring-2 focus:ring-orange-500 font-medium text-sm">
        </div>
    </div>

    <main id="swipe-area" class="pt-20 pb-40 min-h-screen">
        <div id="tab-container" class="flex gap-3 overflow-x-auto no-scrollbar px-6 mb-6 sticky top-[64px] z-30 py-3 bg-[#FCF8F5]/95 backdrop-blur-sm"></div>
        
        <div id="menu-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 px-6 fade-in-up"></div>
    </main>

    <div id="bottom-bar" class="fixed bottom-6 left-1/2 -translate-x-1/2 w-[92%] max-w-md z-50 transition-all duration-300 translate-y-32">
        <div class="bg-slate-900 rounded-[2rem] p-2 flex items-center justify-between shadow-2xl border border-white/10">
            <div class="flex flex-col ml-6 text-white">
                <span id="cart-count-label" class="text-[10px] text-slate-400 font-bold uppercase tracking-widest">0 Items</span>
                <span id="total-bottom" class="font-bold text-sm text-orange-400">Rp 0</span>
            </div>
            <button onclick="toggleCart()" class="bg-orange-600 text-white px-8 py-3.5 rounded-full font-black text-xs uppercase active:scale-95 transition-all">
                Liat Keranjang
            </button>
        </div>
    </div>

    <div id="cart-sidebar" class="fixed inset-y-0 right-0 w-full md:w-[450px] bg-white shadow-2xl z-[60] translate-x-full flex flex-col">
        <div class="p-6 flex items-center justify-between border-b">
            <button onclick="toggleCart()" class="p-2 -ml-2 text-slate-400"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg></button>
            <h3 class="font-black text-sm uppercase tracking-widest">Pesanan Saya</h3>
            <button onclick="clearCart()" class="text-[10px] font-bold text-red-500 uppercase bg-red-50 px-3 py-2 rounded-xl">Hapus</button>
        </div>
        <div class="p-4 space-y-4 bg-slate-50 border-b">
            <div>
                <label class="text-[10px] font-bold text-slate-400 uppercase ml-1">Nama Pemesan</label>
                <input type="text" id="user-name" placeholder="Masukkan nama Anda" class="w-full mt-1 bg-white border border-slate-200 rounded-xl py-3 px-4 focus:outline-none focus:ring-2 focus:ring-orange-500 font-bold text-sm">
            </div>
            <div class="grid grid-cols-2 gap-2">
                <button id="opt-takeaway" onclick="setMode('takeaway')" class="py-3 rounded-xl font-bold text-[11px] uppercase border-2 border-orange-500 bg-orange-500 text-white">ü•° Takeaway</button>
                <button id="opt-delivery" onclick="setMode('delivery')" class="py-3 rounded-xl font-bold text-[11px] uppercase border-2 border-slate-200 bg-white text-slate-400">üöö Delivery</button>
            </div>
        </div>
        <div id="cart-items" class="flex-1 overflow-y-auto p-6 space-y-4 no-scrollbar"></div>
        <div class="p-8 border-t bg-slate-50">
            <div class="flex justify-between items-start mb-2 font-bold uppercase tracking-wider text-xs text-slate-400">
                <span>Total Pesanan</span>
                <span id="cart-subtotal" class="text-slate-900 text-xl font-black block">Rp 0</span>
            </div>
            <p id="delivery-info" class="text-[10px] text-slate-500 font-medium text-right mb-6 hidden">
                *Belum termasuk biaya pengiriman. Tarif akan dihitung <br> berdasarkan jarak ke lokasi Anda.
            </p>
            <button onclick="checkoutWA()" class="w-full bg-green-600 text-white py-5 rounded-[2rem] font-black text-sm shadow-xl active:scale-95 transition-all">LANJUT KE WHATSAPP</button>
        </div>
    </div>
    <div id="overlay" onclick="toggleCart()" class="fixed inset-0 bg-black/60 hidden z-50 backdrop-blur-sm"></div>

    <script>
        let menuData = {};
        let cart = JSON.parse(localStorage.getItem('sushieat_cart')) || [];
        let orderMode = 'takeaway';
        let categories = [];
        let currentCatIndex = 0;
        const noWA = "6282192858970"; 

        // Touch handling variables
        let touchstartX = 0;
        let touchendX = 0;

        window.addEventListener('load', loadData);

        async function loadData() {
            try {
                const response = await fetch('menu.json');
                menuData = await response.json();
                categories = Object.keys(menuData);
                renderTabs();
                updateCartUI();
                initSwipe();
            } catch (e) { console.error("Menu data not found"); }
        }

        function renderTabs() {
            const container = document.getElementById('tab-container');
            container.innerHTML = '';
            categories.forEach((cat, index) => {
                const btn = document.createElement('button');
                btn.id = `tab-${index}`;
                btn.className = "category-chip flex-shrink-0 px-5 py-3 rounded-2xl font-bold text-[11px] bg-white text-slate-400 border border-slate-100 uppercase tracking-wider transition-all";
                btn.innerHTML = cat.replace('_', ' ');
                btn.onclick = () => switchCategory(index);
                container.appendChild(btn);
            });
            switchCategory(0);
        }

        function switchCategory(index) {
            currentCatIndex = index;
            const catName = categories[index];
            
            // UI Update Tabs
            document.querySelectorAll('.category-chip').forEach(b => b.classList.remove('active'));
            const activeTab = document.getElementById(`tab-${index}`);
            activeTab.classList.add('active');
            activeTab.scrollIntoView({ behavior: 'smooth', inline: 'center' });

            // 1. Reset Page to Top
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Render Menu with animation
            const grid = document.getElementById('menu-grid');
            grid.classList.remove('fade-in-up');
            void grid.offsetWidth; // Trigger reflow
            grid.classList.add('fade-in-up');
            
            renderMenu(menuData[catName]);
        }

        function renderMenu(items) {
            const grid = document.getElementById('menu-grid');
            grid.innerHTML = items.map(item => `
                <div class="bg-white rounded-[2.5rem] p-3 shadow-sm border border-orange-50 flex flex-col active:scale-95 transition-all">
                    <div class="rounded-[2rem] mb-3 aspect-square bg-slate-50 overflow-hidden">
                        <img src="https://images.unsplash.com/photo-1579871494447-9811cf80d66c?w=400&q=80" class="w-full h-full object-cover">
                    </div>
                    <h3 class="font-bold text-slate-800 text-[11px] uppercase px-2 line-clamp-2 h-8 leading-tight mb-2">${item.name}</h3>
                    <div class="flex items-center justify-between mt-auto px-2 pb-1">
                        <span class="text-orange-600 font-black text-sm">Rp${item.price.toLocaleString()}</span>
                        <button onclick="addToCart('${item.name.replace(/'/g, "\\'")}', ${item.price})" class="bg-slate-900 text-white p-2.5 rounded-2xl shadow-lg active:bg-orange-600 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M12 4v16m8-8H4" /></svg>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // SWIPE LOGIC
        function initSwipe() {
            const swipeArea = document.getElementById('swipe-area');

            swipeArea.addEventListener('touchstart', e => {
                touchstartX = e.changedTouches[0].screenX;
            }, {passive: true});

            swipeArea.addEventListener('touchend', e => {
                touchendX = e.changedTouches[0].screenX;
                handleSwipe();
            }, {passive: true});
        }

        function handleSwipe() {
            const threshold = 100; // Jarak minimal geser (pixel)
            if (touchendX < touchstartX - threshold) {
                // Geser Kiri -> Next Category
                if (currentCatIndex < categories.length - 1) {
                    switchCategory(currentCatIndex + 1);
                }
            }
            if (touchendX > touchstartX + threshold) {
                // Geser Kanan -> Prev Category
                if (currentCatIndex > 0) {
                    switchCategory(currentCatIndex - 1);
                }
            }
        }

        // Logic lainnya (addToCart, updateCartUI, checkoutWA, dll) tetap sama ...
        function addToCart(name, price) {
            const item = cart.find(i => i.name === name);
            if (item) item.quantity++; else cart.push({ name, price, quantity: 1 });
            saveCart(); updateCartUI();
            if (navigator.vibrate) navigator.vibrate(40);
        }

        function updateCartUI() {
            const container = document.getElementById('cart-items');
            const bottomBar = document.getElementById('bottom-bar');
            const count = cart.reduce((a, b) => a + b.quantity, 0);
            const total = cart.reduce((a, b) => a + (b.price * b.quantity), 0);
            document.getElementById('cart-count-label').innerText = `${count} Items`;
            document.getElementById('total-bottom').innerText = `Rp ${total.toLocaleString()}`;
            document.getElementById('cart-subtotal').innerText = `Rp ${total.toLocaleString()}`;
            if(count > 0) bottomBar.classList.remove('translate-y-32'); else bottomBar.classList.add('translate-y-32');
            if (cart.length === 0) { container.innerHTML = `<div class='h-40 flex flex-col items-center justify-center opacity-20'><span class='text-5xl'>üç±</span></div>`; return; }
            container.innerHTML = cart.map((item, i) => `
                <div class="flex items-center gap-4 bg-slate-50 p-4 rounded-[2rem] border border-slate-100">
                    <div class="flex-1"><h4 class="font-bold text-[11px] uppercase text-slate-700">${item.name}</h4><p class="text-orange-600 font-black text-sm mt-1">Rp ${(item.price * item.quantity).toLocaleString()}</p></div>
                    <div class="flex items-center gap-3 bg-white px-3 py-2 rounded-2xl border border-slate-100">
                        <button onclick="updateQty(${i}, -1)" class="font-bold text-slate-300">-</button>
                        <span class="font-black text-sm w-4 text-center">${item.quantity}</span>
                        <button onclick="updateQty(${i}, 1)" class="font-bold text-orange-600">+</button>
                    </div>
                </div>
            `).join('');
        }

        function updateQty(i, c) { if (cart[i].quantity + c > 0) cart[i].quantity += c; else cart.splice(i, 1); saveCart(); updateCartUI(); }
        function clearCart() { if (confirm('Hapus semua?')) { cart = []; saveCart(); updateCartUI(); toggleCart(false); } }
        function saveCart() { localStorage.setItem('sushieat_cart', JSON.stringify(cart)); }

        function setMode(mode) {
            orderMode = mode;
            document.getElementById('delivery-info').classList.toggle('hidden', mode === 'takeaway');
            document.getElementById('opt-takeaway').className = (mode === 'takeaway') ? "py-3 rounded-xl font-bold text-[11px] uppercase transition-all border-2 border-orange-500 bg-orange-500 text-white" : "py-3 rounded-xl font-bold text-[11px] uppercase transition-all border-2 border-slate-200 bg-white text-slate-400";
            document.getElementById('opt-delivery').className = (mode === 'delivery') ? "py-3 rounded-xl font-bold text-[11px] uppercase transition-all border-2 border-orange-500 bg-orange-500 text-white" : "py-3 rounded-xl font-bold text-[11px] uppercase transition-all border-2 border-slate-200 bg-white text-slate-400";
        }

        function toggleCart(push = true) {
            const sidebar = document.getElementById('cart-sidebar');
            const overlay = document.getElementById('overlay');
            const isOpen = !sidebar.classList.contains('translate-x-full');
            if (!isOpen) { sidebar.classList.remove('translate-x-full'); overlay.classList.remove('hidden'); if(push) history.pushState({cartOpen: true}, ''); }
            else { sidebar.classList.add('translate-x-full'); overlay.classList.add('hidden'); }
        }

        function toggleSearch() {
            const s = document.getElementById('search-container');
            s.classList.toggle('-translate-y-full'); s.classList.toggle('opacity-0');
            if(!s.classList.contains('opacity-0')) document.getElementById('search-input').focus();
        }

        function searchMenu() {
            const q = document.getElementById('search-input').value.toLowerCase();
            let f = []; Object.keys(menuData).forEach(cat => { f = [...f, ...menuData[cat].filter(i => i.name.toLowerCase().includes(q))]; });
            renderMenu(f);
        }

        function checkoutWA() {
            const name = document.getElementById('user-name').value.trim();
            if (!name) return alert("Mohon masukkan nama Anda.");
            if (cart.length === 0) return;
            let msg = `*PESANAN SUSHI EAT*\n-------------------------\nüë§ *Nama:* ${name}\nüì¶ *Metode:* ${orderMode.toUpperCase()}\n-------------------------\n`;
            cart.forEach(i => msg += `‚Ä¢ ${i.name} (${i.quantity}x)\n`);
            const total = cart.reduce((a, b) => a + (b.price * b.quantity), 0);
            msg += `-------------------------\nüí∞ *Total: Rp ${total.toLocaleString()}*\n\n`;
            if (orderMode === 'delivery') msg += `üìç *Alamat:* (Tulis alamat lengkap/titik maps)`;
            window.open(`https://wa.me/${noWA}?text=${encodeURIComponent(msg)}`);
        }
        async function loadData() {
    // Catat waktu mulai
    const startTime = Date.now();
    
    try {
        const response = await fetch('menu.json');
        menuData = await response.json();
        categories = Object.keys(menuData);
        renderTabs();
        updateCartUI();
        initSwipe();

        // Hitung sisa waktu tunggu agar genap 2 detik
        const elapsedTime = Date.now() - startTime;
        const remainingTime = Math.max(1350 - elapsedTime, 0);

        setTimeout(() => {
            const splash = document.getElementById('splash-screen');
            splash.classList.add('opacity-0'); // Transisi transparan
            setTimeout(() => {
                splash.style.display = 'none'; // Hilangkan dari DOM
            }, 700); // Sesuai durasi duration-700 di class HTML
        }, remainingTime);

    } catch (e) { 
        console.error("Menu data not found");
        // Tetap hilangkan splash jika error agar user tidak stuck
        document.getElementById('splash-screen').style.display = 'none';
    }
}

    </script>
</body>
</html>
